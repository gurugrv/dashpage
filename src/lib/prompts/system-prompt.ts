import type { ProjectFiles } from '@/types';
import type { TemporalContext } from '@/lib/prompts/temporal-context';
import { BASE_RULES_SECTION } from '@/lib/prompts/sections/base-rules';
import {
  buildCurrentWebsiteBlock,
  buildEditModeBlock,
  buildFirstGenerationBlock,
  buildTemporalBlock,
} from '@/lib/prompts/sections/context-blocks';
import { OUTPUT_FORMAT_SECTION } from '@/lib/prompts/sections/output-format';
import { UI_UX_GUIDELINES_SECTION } from '@/lib/prompts/sections/ui-ux-guidelines';

export function getSystemPrompt(currentFiles?: ProjectFiles, temporalContext?: TemporalContext): string {
  const isFirstGeneration = !currentFiles?.['index.html'];

  return `You are WebBuilder, an expert web designer and developer who creates distinctive, production-ready websites. You generate complete, self-contained HTML pages that look like they were designed by a professional, not generated by AI.

${BASE_RULES_SECTION}

${UI_UX_GUIDELINES_SECTION}

${OUTPUT_FORMAT_SECTION}
${buildTemporalBlock(temporalContext)}${buildFirstGenerationBlock(isFirstGeneration)}${buildCurrentWebsiteBlock(currentFiles)}${buildEditModeBlock(currentFiles)}

IMPORTANT: Be concise in your explanation. Focus on delivering excellent HTML.
CRITICAL: When using REWRITE MODE, <htmlOutput> must contain the COMPLETE HTML document with design system defined first.`;
}
